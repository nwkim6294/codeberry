<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>메인 홀 - SECRET CLUB</title>
    <link rel="stylesheet" href="/css/club-common.css">
</head>
<body>
    <!-- 네비게이션 -->
    <nav class="club-nav">
        <div class="nav-content">
            <div class="nav-logo">🏠 SECRET CLUB</div>
            <div class="nav-links">
                <span class="nav-user" sec:authentication="name"></span>
                <a href="/club/logout" class="club-link">로그아웃</a>
            </div>
        </div>
    </nav>

    <!-- 배경 파티클 -->
    <div class="background-particles" id="particles"></div>
    
    <div class="club-container main-container">
        <div style="max-width: 1000px; margin: 0 auto;">
            
            <!-- 환영 섹션 -->
			<div class="welcome-section">
			    <h1 class="club-logo neon-text">🎉 WELCOME TO THE CLUB</h1>
			    <div class="user-status">
			        <h2 style="color: var(--neon-blue); margin-bottom: 1rem;">안녕하세요, <span sec:authentication="name"></span>님! 🎊</h2>
			        <p style="color: var(--gray-text);">
			            현재 권한: 
			            <span sec:authorize="hasRole('ADMIN')" style="color: var(--error-red); font-weight: bold;">👑 관리자</span>
			            <span sec:authorize="hasRole('VIP') and !hasRole('ADMIN')" style="color: var(--neon-purple); font-weight: bold;">⭐ VIP 회원</span>
			            <span sec:authorize="hasRole('USER') and !hasRole('VIP')" style="color: var(--neon-blue); font-weight: bold;">👤 일반 회원</span>
			        </p>
			    </div>
			</div>
			
            <!-- 클럽 구역들 -->
            <div class="club-areas">
                
                <!-- 일반 라운지 -->
                <div class="area-card" onclick="location.href='/club/lounge'">
                    <div class="area-icon">🛋️</div>
                    <h3 class="area-title">일반 라운지</h3>
                    <p class="area-description">
                        편안한 휴식과 대화를 즐길 수 있는 공간입니다.<br>
                        모든 회원이 이용 가능합니다.
                    </p>
                </div>

                <!-- VIP 라운지 - ✅ 수정된 부분 -->
                <div class="area-card" 
                     onclick="checkVipAccess()"
                     data-has-vip="false"
                     th:attr="data-has-vip=${#authorization.expression('hasRole(''VIP'')')}">
                    <div class="area-icon">⭐</div>
                    <h3 class="area-title">VIP 라운지</h3>
                    <p class="area-description">
                        VIP 회원 전용 특별 공간입니다.<br>
                        프리미엄 서비스를 경험해보세요.
                    </p>
                    <div sec:authorize="!hasRole('VIP')" style="color: var(--error-red); font-size: 0.8rem; margin-top: 0.5rem;">
                        VIP 권한이 필요합니다
                    </div>
                </div>

                <!-- 관리자 대시보드 - ✅ 수정된 부분 -->
                <div class="area-card" 
                     onclick="checkAdminAccess()"
                     data-has-admin="false"
                     th:attr="data-has-admin=${#authorization.expression('hasRole(''ADMIN'')')}">
                    <div class="area-icon">🔧</div>
                    <h3 class="area-title">관리자 대시보드</h3>
                    <p class="area-description">
                        시스템 관리 및 설정 공간입니다.<br>
                        고급 관리 기능을 제공합니다.
                    </p>
                    <div sec:authorize="!hasRole('ADMIN')" style="color: var(--error-red); font-size: 0.8rem; margin-top: 0.5rem;">
                        관리자 권한이 필요합니다
                    </div>
                </div>

                <!-- 게임 존 -->
                <div class="area-card" onclick="location.href='/club/games'">
                    <div class="area-icon">🎮</div>
                    <h3 class="area-title">게임 존</h3>
                    <p class="area-description">
                        재미있는 보안 게임과 퀴즈가 있습니다.<br>
                        즐겁게 Spring Security를 배워보세요.
                    </p>
                </div>

                <!-- 상담소 -->
                <div class="area-card" onclick="location.href='/club/counseling'">
                    <div class="area-icon">💬</div>
                    <h3 class="area-title">셜록 누렁의 상담소</h3>
                    <p class="area-description">
                        Spring Security 관련 궁금한 점을 해결해드립니다.<br>
                        언제든 편하게 문의하세요!
                    </p>
                </div>

                <!-- 내 프로필 -->
                <div class="area-card" onclick="location.href='/club/profile'">
                    <div class="area-icon">👤</div>
                    <h3 class="area-title">내 프로필</h3>
                    <p class="area-description">
                        내 정보를 확인하고 관리할 수 있습니다.<br>
                        활동 기록도 볼 수 있어요!
                    </p>
                </div>
            </div>

            <!-- 셜록 누렁의 한마디 -->
            <div style="text-align: center; padding: 3rem 0; border-top: 1px solid rgba(255, 0, 128, 0.2);">
                <h3 style="color: var(--neon-pink); margin-bottom: 1rem;">🕵️‍♂️ 셜록 누렁의 한마디</h3>
                <blockquote style="font-style: italic; color: var(--gray-text); font-size: 1.1rem; max-width: 600px; margin: 0 auto;">
                    "보안은 단순히 코드만의 문제가 아니에요용!<br>
                    사용자 경험과 보안성의 균형을 맞추는 것이 진짜 어려운 일이죠용!<br>
                    함께 배우고 성장해봅시다용!"
                </blockquote>
                <p style="color: var(--neon-blue); margin-top: 1rem; font-weight: 600;">- 셜록 누렁 -</p>
            </div>
        </div>
    </div>

    <script>
        // 파티클 생성 함수
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 30;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 8 + 's';
                particle.style.animationDuration = (8 + Math.random() * 4) + 's';
                
                const colors = ['#ff0080', '#00ffff', '#8000ff'];
                particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                
                particlesContainer.appendChild(particle);
            }
        }

        // ✅ 수정된 VIP 권한 확인 함수
        function checkVipAccess() {
            const vipCard = document.querySelector('[onclick="checkVipAccess()"]');
            const hasVip = vipCard.getAttribute('data-has-vip') === 'true';
            
            if (hasVip) {
                location.href = '/club/vip';
            } else {
                alert('VIP 권한이 필요합니다용! ⭐\n\nVIP 회원이 되시려면 관리자에게 문의하세요!');
            }
        }

        // ✅ 수정된 관리자 권한 확인 함수
        function checkAdminAccess() {
            const adminCard = document.querySelector('[onclick="checkAdminAccess()"]');
            const hasAdmin = adminCard.getAttribute('data-has-admin') === 'true';
            
            if (hasAdmin) {
                location.href = '/club/admin';
            } else {
                alert('관리자 권한이 필요합니다용! 🔧\n\n접근이 제한된 영역입니다!');
            }
        }

        document.addEventListener('DOMContentLoaded', createParticles);

        // 웰컴 메시지 (선택사항)
        setTimeout(() => {
            const messages = [
                '셜록 누렁이 환영합니다용! 🕵️‍♂️',
                '오늘도 보안 학습 화이팅이에욘! 💪',
                '새로운 기능들을 탐험해보세욘! 🚀',
                '궁금한 것이 있으면 언제든 물어보세욘! 💬'
            ];
            const randomMessage = messages[Math.floor(Math.random() * messages.length)];
            
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                top: 120px;
                right: 20px;
                background: rgba(0, 255, 255, 0.9);
                color: #000;
                padding: 1rem 1.5rem;
                border-radius: 10px;
                font-weight: 600;
                z-index: 2000;
                animation: slideInRight 0.5s ease;
            `;
            toast.textContent = randomMessage;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideOutRight 0.5s ease';
                setTimeout(() => toast.remove(), 500);
            }, 3000);
        }, 1000);

        // CSS 애니메이션 추가
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOutRight {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
